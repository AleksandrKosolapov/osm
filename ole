Для объяснения процесса, который описан в вашем запросе, давайте рассмотрим шаги и механизмы, которые происходят при обновлении Excel файла:

Обращение к БД через OLE DB:
Excel файл использует технологию OLE DB (Object Linking and Embedding Database) для подключения и работы с данными из различных источников данных. В данном случае, источником данных является база данных на сервере SQL Server 2014 (srv-sql2014.bitrix.dbo).
Процедуры "kub_dl" и "kub_pl":
Процедуры (routines) kub_dl и kub_pl - это хранимые процедуры, которые находятся в базе данных на указанном SQL сервере (srv-sql2014.bitrix.dbo). Эти процедуры, вероятно, написаны на T-SQL (Transact-SQL) и выполняют определенные операции на данных в базе.
Обновление вкладок "реестр Дл" и "реестр ПЛ":
В Excel имеются вкладки "реестр Дл" и "реестр ПЛ", которые, видимо, содержат данные, полученные из этих процедур. При обновлении файла Excel, он инициирует выполнение процедур kub_dl и kub_pl на SQL сервере.
Взаимодействие с сервером и получение данных:
Шаг 1: Excel открывает соединение с SQL сервером через OLE DB.
Шаг 2: Excel отправляет команду на выполнение хранимых процедур kub_dl и kub_pl.
Шаг 3: SQL сервер выполняет эти процедуры. Результатами выполнения процедур являются наборы данных.
Шаг 4: Эти данные возвращаются в Excel через OLE DB соединение.
Заполнение данных в Excel:
Вкладка "реестр Дл" получает данные, возвращаемые процедурой kub_dl.
Вкладка "реестр ПЛ" заполняется данными, возвращаемыми процедурой kub_pl.
Под капотом:
Хранимые процедуры: Выполнение процедур на сервере включает в себя SQL запросы, которые могут включать в себя выборку данных (SELECT), выполнение сложных вычислений, фильтрацию данных, объединение нескольких таблиц и другие операции, необходимые для формирования итоговых наборов данных.
Транспорт данных: Данные передаются обратно в Excel через сетевое соединение, используя протоколы и форматы, поддерживаемые OLE DB.
Обновление листов: В Excel предусмотрены механизмы импорта данных, позволяющие обновить существующие таблицы (например, с помощью функции «Обновить все» в Power Query), отображая актуальную информацию из базы данных.
Таким образом, общая схема работы выглядит следующим образом: Excel инициирует выполнение хранимых процедур на SQL сервере и обновляет свои вкладки данными, возвращенными этими процедурами. Технологии OLE DB и T-SQL являются основными инструментами для выполнения взаимодействий и обработки данных.

